---
import BaseLayout from "../../../layouts/BaseLayout.astro";
import PageMasthead from "../../../components/PageMasthead.astro";
import { formatTagForPath, getAllTagsWithCount } from "../../../utils/posts";
import type { SiteLocale } from "../../../utils/i18n";

const locale: SiteLocale = "en-US";
const tags = await getAllTagsWithCount(locale);
---

<BaseLayout
  title="Tags"
  description="Topic index for DWILL Blog. Browse articles by subject."
>
  <div class="page-center">
    <PageMasthead
      kicker="Tag Index"
      title="All Tags"
      subtitle={`${tags.length} tags currently indexed.`}
      sideKicker="How to use"
      sideTitle="Pick a topic, then read"
      sideText="Each tag groups related posts so you can follow one subject end-to-end."
      metrics={[
        { value: String(tags.length), label: "Tag count" },
        { value: "Topic clusters", label: "Structure" },
      ]}
    />

    <section class="tag-card-grid" aria-label="Tag index">
      {
        tags.map(([tag, count]) => (
          <article class="surface-card tag-card">
            <a href={`/en/tags/${formatTagForPath(tag)}/`}>
              <p class="surface-kicker">Topic</p>
              <h3>#{tag}</h3>
              <p>{count} article{count > 1 ? "s" : ""}</p>
            </a>
          </article>
        ))
      }
    </section>
  </div>
</BaseLayout>
